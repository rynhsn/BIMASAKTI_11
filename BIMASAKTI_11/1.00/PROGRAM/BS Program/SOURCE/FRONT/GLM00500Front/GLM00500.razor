@page "/GLM00500"
@using GLM00500Common.DTOs
@inherits R_Page

<R_TabStrip>
    <R_TabStripTab Title="List">
        <R_StackLayout Row Class="mb-3">
            <R_ItemLayout Class="me-4">
                <R_Label>Year</R_Label>
            </R_ItemLayout>
            <R_ItemLayout xs="1">
                <R_NumericTextBox @bind-Value="@_viewModel.SelectedYear" Min="@_viewModel.Periods.IMIN_YEAR" Max="@_viewModel.Periods.IMAX_YEAR" R_ConductorSource="_conductorRef" Step="1"/>
            </R_ItemLayout>
            <R_ItemLayout xs="1">
                <R_Button OnClick="RefreshList" R_ConductorSource="_conductorRef" R_EnableOther="true">Refresh</R_Button>
            </R_ItemLayout>
        </R_StackLayout>

        <R_StackLayout>
            <R_ItemLayout>
                <R_Grid @ref="_gridRef"
                        DataSource="_viewModel.BudgetHDList"
                        Pageable="true"
                        R_ConductorSource="_conductorRef"
                        R_GridType="R_eGridType.Navigator"
                        R_ServiceGetListRecord="GetBudgetHDList"
                        PageSize="20">
                    <R_GridColumns>
                        <R_GridTextColumn FieldName="CBUDGET_NO" HeaderText="Budget No."/>
                        <R_GridTextColumn FieldName="CBUDGET_NAME" HeaderText="Budget Name"/>
                        <R_GridTextColumn FieldName="CCURRENCY_TYPE" HeaderText="Currency Type"/>
                        <R_GridCheckBoxColumn FieldName="LFINAL" HeaderText="Final"/>
                        <R_GridTextColumn FieldName="CUPDATE_BY" HeaderText="Updated By"/>
                        <R_GridDateTimePickerColumn FieldName="DUPDATE_DATE" HeaderText="Updated Date"/>
                        <R_GridTextColumn FieldName="CCREATE_BY" HeaderText="Created By"/>
                        <R_GridDateTimePickerColumn FieldName="DCREATE_DATE" HeaderText="Created Date"/>
                    </R_GridColumns>

                </R_Grid>
            </R_ItemLayout>
        </R_StackLayout>

        <R_GroupBox ShowBorder="true">
            <R_StackLayout Row>
                <R_ItemLayout xs="1">
                    <R_Label>Budget No.</R_Label>
                </R_ItemLayout>
                <R_ItemLayout xs="1">
                    <R_TextBox @bind-Value="_viewModel.Data.CBUDGET_NO" 
                               R_ConductorSource="_conductorRef" 
                               MaxLength="20" 
                               R_EnableAdd/>
                </R_ItemLayout>
                <R_ItemLayout xs="1">
                    <R_CheckBox @bind-Value="_viewModel.Data.LFINAL" 
                                R_ConductorSource="_conductorRef" 
                                Enabled="false"/>
                    <R_Label>Final</R_Label>
                </R_ItemLayout>
            </R_StackLayout>
            <R_StackLayout Row>
                <R_ItemLayout xs="1">
                    <R_Label>Budget Name</R_Label>
                </R_ItemLayout>
                <R_ItemLayout xs="3">
                    <R_TextBox @bind-Value="_viewModel.Data.CBUDGET_NAME" 
                               R_ConductorSource="_conductorRef" 
                               MaxLength="50" 
                               R_EnableAdd 
                               R_EnableEdit/>
                </R_ItemLayout>
            </R_StackLayout>
            <R_StackLayout Row>
                <R_ItemLayout xs="1">
                    <R_Label>Currency Type</R_Label>
                </R_ItemLayout>
                <R_ItemLayout xs="2">
                    <R_ComboBox Data="_viewModel.CurrencyTypeList" 
                                @bind-Value="_viewModel.Data.CCURRENCY_TYPE"
                                ValueField="@nameof(GLM00500FunctionDTO.CCODE)"
                                TextField="@nameof(GLM00500FunctionDTO.CDESCRIPTION)"
                                R_ConductorSource="_conductorRef" 
                                R_EnableAdd 
                                R_EnableEdit/>
                </R_ItemLayout>
            </R_StackLayout>
        </R_GroupBox>
        
        <R_AddButton R_Conductor="_conductorRef"/>
        <R_EditButton R_Conductor="_conductorRef"/>
        <R_CancelButton R_Conductor="_conductorRef"/>
        <R_SaveButton R_Conductor="_conductorRef"/>

    </R_TabStripTab>
    <R_TabStripTab Title="Detail">
        <label>detail</label>
    </R_TabStripTab>
</R_TabStrip>
    
<R_Conductor @ref="@_conductorRef"
             R_ViewModel="@_viewModel"
             R_IsHeader="true"
             R_ServiceGetRecord="@GetBudgetHD"/>