@page "/GSM04500"
@using R_BlazorFrontEnd.Interfaces
@using GSM04500FrontResources
@using GSM04500Common.DTOs
@inherits R_Page
@attribute [R_Page(Title = "Journal Group")]
@inject R_ILocalizer<Resources_Dummy_Class> _localizer


<R_StackLayout Row Class="justify-content-between mb-2">
    <R_ItemLayout col="6">
        <R_StackLayout Row Spacing="2">
            <R_ItemLayout>
                <R_Label FontStyle="R_eFontStyle.Bold" 
                         FontColor="R_eFontColor.Danger">
                    @_localizer["LBL_PROPERTY"]
                </R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="6">
                <R_ComboBox R_ConductorGridSource="@_conductorRef"
                            Data="@_viewModel.PropertyList"
                            Value="@_viewModel.PropertyId"
                            ValueField="@nameof(GSM04500PropertyDTO.CPROPERTY_ID)"
                            TextField="@nameof(GSM04500PropertyDTO.CPROPERTY_NAME)"
                            ValueChanged="@((string value) => OnChangeParam(value, "property"))"
                            Enabled="_flagCombo"/>
            </R_ItemLayout>
        </R_StackLayout>
    </R_ItemLayout>

    <R_ItemLayout col="6" Class="align-items-end">
        <R_StackLayout Row Spacing="2">
            <R_ItemLayout>@_localizer["LBL_JRNLGRPTYPE"]</R_ItemLayout>
            <R_ItemLayout col="6">
                <R_ComboBox R_ConductorGridSource="@_conductorRef"
                            Data="@_viewModel.TypeList"
                            Value="@_viewModel.TypeCode"
                            ValueField="@nameof(GSM04500FunctionDTO.CCODE)"
                            TextField="@nameof(GSM04500FunctionDTO.CDESCRIPTION)"
                            ValueChanged="@((string value) => OnChangeParam(value, "type"))"
                            Enabled="_flagCombo"/>
            </R_ItemLayout>
        </R_StackLayout>
    </R_ItemLayout>
</R_StackLayout>

<R_TabStrip @ref="_tab" OnActiveTabIndexChanging="@OnChangeTab">
    <R_TabStripTab Title="Journal Group" Id="JournalGroup">
        <R_StackLayout Class="mb-2">
            <R_ItemLayout>
                <R_Grid @ref="@_gridRef"
                        DataSource="@_viewModel.GridList"
                        Pageable
                        R_ConductorGridSource="@_conductorRef"
                        R_GridType="R_eGridType.Original"
                        R_ServiceGetListRecord="@GetGridList"
                        AllowAddNewRow
                        AllowDeleteRow
                        AllowEditRow
                        Height="350px">
                    <R_GridColumns>
                        <R_GridTextColumn FieldName="@nameof(GSM04500JournalGroupDTO.CJRNGRP_CODE)" HeaderText="@_localizer["LBL_JRNLGRP"]" TextAlignment="R_eTextAlignment.Left" Width="150px" MaxLength="8" R_EnableAdd/>
                        <R_GridTextColumn FieldName="@nameof(GSM04500JournalGroupDTO.CJRNGRP_NAME)" HeaderText="@_localizer["LBL_JRNLGRPNAME"]" TextAlignment="R_eTextAlignment.Left" Width="250px" MaxLength="80" R_EnableAdd R_EnableEdit/>
                        <R_GridCheckBoxColumn FieldName="@nameof(GSM04500JournalGroupDTO.LACCRUAL)" TextAlignment="R_eTextAlignment.Center" HeaderText="@_localizer["LBL_ENACCRUAL"]" Width="150px" Visible="@(_viewModel.TypeCode is "10" or "11" or "40")" R_EnableAdd R_EnableEdit/>
                        <R_GridTextColumn FieldName="@nameof(GSM04500JournalGroupDTO.CUPDATE_BY)" HeaderText="@_localizer["LBL_UPDATEDBY"]" Width="150px"/>
                        <R_GridDateTimePickerColumn FieldName="@nameof(GSM04500JournalGroupDTO.DUPDATE_DATE)" HeaderText="@_localizer["LBL_UPDATEDDATE"]" Width="250px"/>
                        <R_GridTextColumn FieldName="@nameof(GSM04500JournalGroupDTO.CCREATE_BY)" HeaderText="@_localizer["LBL_CREATEDBY"]" Width="150px"/>
                        <R_GridDateTimePickerColumn FieldName="@nameof(GSM04500JournalGroupDTO.DCREATE_DATE)" HeaderText="@_localizer["LBL_CREATEDDATE"]" Width="250px"/>
                    </R_GridColumns>
                </R_Grid>
            </R_ItemLayout>
        </R_StackLayout>

        <R_StackLayout Row>
            <R_ItemLayout>
                <R_Button
                    OnClick="DownloadTemplate"
                    R_ConductorGridSource="_conductorRef"
                    R_EnableOther="true">
                    @_localizer["LBL_TEMPLATE"]
                </R_Button>
            </R_ItemLayout>

            <R_ItemLayout>
                <R_Popup
                    R_ConductorGridSource="_conductorRef"
                    R_EnableOther="true"
                    R_Before_Open_Popup="BeforeOpenUpload"
                    R_After_Open_Popup="AfterOpenUpload">
                    @_localizer["LBL_UPLOAD"]
                </R_Popup>
            </R_ItemLayout>
        </R_StackLayout>


        <R_ConductorGrid @ref="@_conductorRef"
                         R_ViewModel="_viewModel"
                         R_IsHeader
                         R_Display="Display"
                         R_SetOther="SetOther"
                         R_ServiceGetRecord="@GetRecord"
                         R_AfterAdd="AfterAdd"
                         R_ServiceSave="Save"
                         R_ServiceDelete="Delete"/>
    </R_TabStripTab>
    <R_TabStripTab @ref="_tabAccSetting" Title="Account Setting">
        <R_TabPage R_Before_Open_TabPage="BeforeOpenAccSetting"/>
    </R_TabStripTab>
</R_TabStrip>